Obesity Prevalence

/*Create Obesity prevalence Dataset*/
CREATE TABLE `obesity`.`Obesity_Prevalence` (
  `idObesity_Prevalence` INT NOT NULL AUTO_INCREMENT,
  `County` VARCHAR(100) NOT NULL,
  `Prevalence` INT NOT NULL,
  `MarginError_Low` INT NOT NULL,
  `MarginError_High` INT NOT NULL,
  PRIMARY KEY (`idObesity_Prevalence`));
SELECT * FROM obesity.Obesity_Prevalence;
INSERT INTO `obesity`.`Obesity_Prevalance`(`County`, `Prevalence`, `MarginError_Low`, `MarginError_High`) VALUES
  ('Atkinson',37,35,38),
  ('Appling',38,37,40),
  ('Bacon',38,37,40),
  ('Baker',38,37,39),
  ('Baldwin',40,38,41),
  ('Banks',40,38,41),
  ('Barrow',34,33,36),
  ('Bartow',32,31,34),
  ('Ben Hill',39,38,41),
  ('Berrien',37,35,38),
  ('Bibb',39,37,40),
  ('Bleckley',38,36,39),
  ('Brantley',38,36,40),
  ('Brooks',37,36,38),
  ('Bryan',34,32,35),
  ('Bulloch',38,36,39),
  ('Burke',38,37,40),
  ('Butts',37,35,38),
  ('Calhoun',43,42,45),
  ('Camden',35,34,36),
  ('Candler',39,38,41),
  ('Carroll',34,33,35),
  ('Catoosa',35,33,36),
  ('Charlton',39,38,40),
  ('Chatham',33,32,34),
  ('Chattahoochee',37,36,39),
  ('Chattooga',38,36,39),
  ('Cherokee',33,31,34),
  ('Clarke',36,35,38),
  ('Clay',40,39,41),
  ('Clayton',40,39,41),
  ('Clinch',41,40,42),
  ('Cobb',31,30,32),
  ('Coffee',37,36,38),
  ('Colquitt',37,36,39),
  ('Columbia',31,30,32),
  ('Cook',39,38,41),
  ('Coweta',32,30,33),
  ('Crawford',34,33,36),
  ('Crisp',43,42,45),
  ('Dade',33,31,34),
  ('Dawson',30,28,32),
  ('Decatur',39,37,40),
  ('DeKalb',33,32,34),
  ('Dodge',37,36,39),
  ('Dooly',42,42,43),
  ('Dougherty',39,37,40),
  ('Douglas',34,33,36),
  ('Early',43,41,44),
  ('Echols',36,35,38),
  ('Effingham',31,30,33),
  ('Elbert',37,36,38),
  ('Emanuel',39,38,40),
  ('Evans',39,37,40),
  ('Fannin',30,28,31),
  ('Fayette',31,30,32),
  ('Floyd',33,32,34),
  ('Forsyth',27,25,28),
  ('Franklin',34,33,36),
  ('Fulton',29,28,30),
  ('Gilmer',32,31,34),
  ('Glascock',35,33,37),
  ('Glynn',32,31,33),
  ('Gordon',37,37,39),
  ('Grady',39,38,41),
  ('Greene',37,35,38),
  ('Gwinnett',32,31,33),
  ('Habersham',32,31,34),
  ('Hall',34,33,35),
  ('Hancock',43,41,44),
  ('Haralson',35,32,36),
  ('Harris',32,31,34),
  ('Hart',35,33,36),
  ('Heard',35,33,36),
  ('Henry',36,35,38),
  ('Houston',35,34,36),
  ('Irwin',37,36,39),
  ('Jackson',32,31,34),
  ('Jasper',35,34,37),
  ('Jeff Davis',39,38,41),
  ('Jefferson',42,41,43),
  ('Jenkins',43,42,44),
  ('Johnson',39,37,40),
  ('Jones',36,34,37),
  ('Lamar',36,34,37),
  ('Lanier',37,36,38),
  ('Laurens',40,39,42),
  ('Lee',33,32,35),
  ('Liberty',37,36,38),
  ('Lincoln',38,37,40),
  ('Long',37,36,38),
  ('Lowndes',37,35,38),
  ('Lumpkin',32,31,34),
  ('Macon',42,42,44),
  ('Madison',36,34,37),
  ('Marion',37,36,38),
  ('McDuffie',38,37,39),
  ('McIntosh',37,35,38),
  ('Meriwether',39,38,41),
  ('Miller',38,37,39),
  ('Mitchell',43,42,44),
  ('Monroe',32,30,33),
  ('Montgomery',37,36,38),
  ('Morgan',33,32,35),
  ('Murray',37,35,38),
  ('Muscogee',38,38,39),
  ('Newton',37,36,39),
  ('Oconee',28,27,30),
  ('Oglethorpe',36,35,37),
  ('Paulding',34,33,35),
  ('Peach',37,36,39),
  ('Pickens',31,29,32),
  ('Pierce',37,36,39),
  ('Pike',32,31,34),
  ('Polk',35,34,36),
  ('Pulaski',36,35,37),
  ('Putnam',34,33,36),
  ('Quitman',39,38,41),
  ('Rabun',35,33,37),
  ('Randolph',44,43,46),
  ('Richmond',39,38,40),
  ('Rockdale',38,37,40),
  ('Schley',35,33,36),
  ('Screven',39,37,40),
  ('Seminole',37,36,38),
  ('Spalding',39,38,40),
  ('Stephens',35,33,36),
  ('Stewart',41,39,43),
  ('Sumter',42,40,43),
  ('Talbot',41,40,42),
  ('Taliaferro',40,38,41),
  ('Tattnall',38,36,39),
  ('Taylor',40,39,41),
  ('Telfair',41,40,42),
  ('Terrell',42,41,44),
  ('Thomas',37,36,39),
  ('Tift',37,35,38),
  ('Toombs',38,37,39),
  ('Towns',32,30,33),
  ('Treutlen',39,38,40),
  ('Troup',36,35,39),
  ('Turner',41,40,43),
  ('Twiggs',37,36,39),
  ('Union',31,30,33),
  ('Upson',13,13,14),
  ('Walker',37,36,39),
  ('Walton',32,31,34),
  ('Ware',39,37,40),
  ('Warren',42,40,43),
  ('Washington',41,39,43),
  ('Wayne',35,34,37),
  ('Webster',38,37,39),
  ('Wheeler',41,39,42),
  ('White',30,29,32),
  ('Whitfield',34,33,35),
  ('Wilcox',41,39,42),
  ('Wilkes',38,37,40),
  ('Wilkinson',39,37,40),
  ('Worth',37,36,38);

/*Create Food Desert Dataset*/
  CREATE TABLE obesity`.`Food_Desert` (
  `idFood_Desert` INT NOT NULL AUTO_INCREMENT,
  'State' VARCHAR(255) NOT NULL,
  `County` VARCHAR(255) NOT NULL,
  `LowAccess` INT NOT NULL,
  PRIMARY KEY (`idFood_Desert`));

  SELECT * FROM obesity.Food_Desert;
  INSERT INTO `obesity`.`Food_Desert` (`State`, `County`,`LowAccess_Percent`) VALUES 
  ('GA','Appling',40),
  ('GA','Atkinson',0),
  ('GA','Bacon',0),
  ('GA','Baker',0),
  ('GA','Baldwin',50),
  ('GA','Banks',0),
  ('GA','Barrow',56),
  ('GA','Bartow',40),
  ('GA','Ben Hill',40),
  ('GA','Berrien',0),
  ('GA','Bibb',52),
  ('GA','Bleckley',33),
  ('GA','Brantley',0),
  ('GA','Brooks',20),
  ('GA','Bryan',33),
  ('GA','Bulloch',25),
  ('GA','Burke',17),
  ('GA','Butts',33),
  ('GA','Calhoun',0),
  ('GA','Camden',60),
  ('GA','Candler',0),
  ('GA','Carroll',65),
  ('GA','Catoosa',55),
  ('GA','Charlton',0),
  ('GA','Chatham',49),
  ('GA','Chattahoochee',60),
  ('GA','Chattooga',50),
  ('GA','Cherokee',69),
  ('GA','Clarke',63),
  ('GA','Clay',0),
  ('GA','Clayton',63),
  ('GA','Clinch',0),
  ('GA','Cobb',73),
  ('GA','Coffee',0),
  ('GA','Colquitt',30),
  ('GA','Columbia',55),
  ('GA','Cook',0),
  ('GA','Coweta',65),
  ('GA','Crawford',0),
  ('GA','Crisp',17),
  ('GA','Dade',0),
  ('GA','Dawson',0),
  ('GA','Decatur',29),
  ('GA','Dekalb',50),
  ('GA','Dodge',0),
  ('GA','Dooly',67),
  ('GA','Dougherty',63),
  ('GA','Douglas',70),
  ('GA','Early',0),
  ('GA','Echols',0),
  ('GA','Effingham',20),
  ('GA','Elbert',20),
  ('GA','Emanuel',17),
  ('GA','Evans',0),
  ('GA','Fannin',0),
  ('GA','Fayette',70),
  ('GA','Floyd',55),
  ('GA','Forsyth',80),
  ('GA','Franklin',0),
  ('GA','Fulton',49),
  ('GA','Gilmer',20),
  ('GA','Glascock',0),
  ('GA','Glynn',73),
  ('GA','Gordon',33),
  ('GA','Grady',0),
  ('GA','Greene',14),
  ('GA','Gwinnett',70),
  ('GA','Habersham',25),
  ('GA','Hall',42),
  ('GA','Hancock',50),
  ('GA','Haralson',20),
  ('GA','Harris',0),
  ('GA','Hart',0),
  ('GA','Heard',0),
  ('GA','Henry',80),
  ('GA','Houston',70),
  ('GA','Irwin',0),
  ('GA','Jackson',45),
  ('GA','Jasper',0),
  ('GA','Jeff Davis',33),
  ('GA','Jefferson',0),
  ('GA','Jenkins',0),
  ('GA','Johnson',0),
  ('GA','Jones',33),
  ('GA','Lamar',33),
  ('GA','Lanier',0),
  ('GA','Laurens',31),
  ('GA','Lee',40),
  ('GA','Liberty',50),
  ('GA','Lincoln',0),
  ('GA','Long',0),
  ('GA','Lowndes',36),
  ('GA','Lumpkin',0),
  ('GA','Macon',0),
  ('GA','Madison',0),
  ('GA','Marion',0),
  ('GA','McDuffie',0),
  ('GA','McIntosh',50),
  ('GA','Meriwether',0),
  ('GA','Miller',0),
  ('GA','Mitchell',20),
  ('GA','Monroe',0),
  ('GA','Montgomery',0),
  ('GA','Morgan',20),
  ('GA','Murray',25),
  ('GA','Muscogee',40),
  ('GA','Newton',62),
  ('GA','Oconee',17),
  ('GA','Oglethorpe',0),
  ('GA','Paulding',74),
  ('GA','Peach',17),
  ('GA','Pickens',17),
  ('GA','Pierce',0),
  ('GA','Pike',0),
  ('GA','Polk',29),
  ('GA','Pulaski',0),
  ('GA','Putnam',20),
  ('GA','Quitman',0),
  ('GA','Rabun',0),
  ('GA','Randolph',50),
  ('GA','Richmond',79),
  ('GA','Rockdale',73),
  ('GA','Schley',0),
  ('GA','Screven',0),
  ('GA','Seminole',33),
  ('GA','Spalding',50),
  ('GA','Stephens',40),
  ('GA','Stewart',0),
  ('GA','Sumter',13),
  ('GA','Talbot',0),
  ('GA','Taliaferro',0),
  ('GA','Tattnall',20),
  ('GA','Taylor',0),
  ('GA','Telfair',33),
  ('GA','Terrell',25),
  ('GA','Thomas',36),
  ('GA','Tift',33),
  ('GA','Toombs',17),
  ('GA','Towns',0),
  ('GA','Treutlen',50),
  ('GA','Troup',21),
  ('GA','Turner',50),
  ('GA','Twiggs',0),
  ('GA','Union',0),
  ('GA','Upson',29),
  ('GA','Walker',46),
  ('GA','Walton',47),
  ('GA','Ware',44),
  ('GA','Warren',0),
  ('GA','Washington',20),
  ('GA','Wayne',17),
  ('GA','Webster',0),
  ('GA','Wheeler',0),
  ('GA','White',0),
  ('GA','Whitfield',33),
  ('GA','Wilcox',0),
  ('GA','Wilkes',0),
  ('GA','Wilkinson',0),
  ('GA','Worth',0);

/*Misspelled county needs correction*/
UPDATE `obesity`.`Obesity_Prevalance` SET County = 'Bulloch' 
		WHERE idObesity_Prevalance = 16;

/*Joining table for analysis*/
SELECT `obesity`.`Food_Desert`.idFood_Desert, `obesity`.`Food_Desert`.State, `obesity`.`Food_Desert`.county,
 `obesity`.`Food_Desert`.LowAccess_Percent, `obesity`.`Obesity_Prevalance`.Prevalence,
 `obesity`.`Obesity_Prevalance`.MarginError_Low, 
`obesity`.`Obesity_Prevalance`.MarginError_High  FROM `obesity`.`Food_Desert`
		LEFT OUTER JOIN `obesity`.`Obesity_Prevalance`
		ON `obesity`.`Food_Desert`.County = `obesity`.`Obesity_Prevalance`.County;